<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_product_template_form_tour_package" model="ir.ui.view">
        <field name="name">product.template.form.tour.package</field>
        <field name="model">product.template</field>
        <field name="inherit_id" ref="product.product_template_only_form_view"/>
        <field name="arch" type="xml">

            <!-- Opción A: insertar el checkbox en el grupo general -->
            <xpath expr="//group[@name='group_general']" position="inside">
                <field name="is_tour_package"/>
            </xpath>

            <!-- Nueva pestaña; en v17 NO usar attrs; usar invisible con expresión -->
            <xpath expr="//notebook" position="inside">
                <page string="Paquete de tours" invisible="not is_tour_package">
                    <group>
                        <!-- Para que el modificador funcione incluso si el checkbox fallara en el xpath anterior,
                             dejamos también el campo (oculto) aquí. No molesta y garantiza presencia del campo. -->
                        <field name="is_tour_package" invisible="1"/>

                        <field name="package_line_ids" context="{'default_package_id': active_id}">
                            <tree editable="bottom">
                                <field name="sequence" widget="handle"/>
                                <field name="product_id"/>
                                <field name="note" optional="show"/>
                            </tree>
                            <form>
                                <group>
                                    <field name="sequence"/>
                                    <field name="product_id" options="{'no_create_edit': False}"/>
                                </group>
                                <group>
                                    <field name="note"/>
                                </group>
                            </form>
                        </field>
                    </group>

                    <!-- Texto informativo sin <label> -->
                    <div class="o_form_label" style="margin-top:8px;">
                        Los componentes deben ser productos tour (Es Cupo de Tour) y no pueden ser paquetes.
                    </div>
                </page>
            </xpath>

        </field>
    </record>
    <record id="view_product_template_form_tour_type" model="ir.ui.view">
        <field name="name">product.template.form.tour.type</field>
        <field name="model">product.template</field>
        <field name="inherit_id" ref="product.product_template_only_form_view"/>
        <field name="arch" type="xml">
        <xpath expr="//group[@name='group_general']" position="inside">
            <field name="tour_type_id" modifiers="{'invisible': [('is_tour_ticket','=',False)]}"/>
        </xpath>
    </field>
  </record>
</odoo>
